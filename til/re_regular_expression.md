# 正規表現

## terraform の data 一覧を手に入れる文脈
data.xxx.yyy.…… から data.xxx.yyy のみにする

- from `data\.([\d\c\-]+)\.([\d\c\-]+)\.(.*)`
- to `data.\1.\2`

## 2space indent リストを 4space にする
数字大きい方から調べていく。

```
^([ ]{6})\-
\1\1\-

^([ ]{4})\-
\1\1\-

^([ ]{2})\-
\1\1\-
```

## リンク文字列をつくる
こうしたい

```
	00200521	国勢調査
	↓
	<a href="00200521">国勢調査</a>
```

こうすればいけた。

```
	before: ([0-9]+)\t(.*)
	after : \<a href\=\"\1\"\>\2\<\/a\>
```

## 強調表示
囲み

```
「[^」]+」
"[^"]+"
```

インラインコメント

```
^([\t 　])*\#(.*)
```

アウトライン見出し

```
^(\t*)[■□●○▲△×▼▽].*
```

## 先頭のタブをn文字スペースに変換する

```
置換前: ^( *)\t
置換後: \1    
	→\1の後にnコのスペースを書く
```

## '*'や'?'などを最初の一つだけにマッチさせる
?を付加するといい

```
例: <a:p>から最初に</a:p>の間に一致
\<a\:p\>(.+?)\<\/a\:p\>
           ~
          ここに付加
```

もし `\<a\:p\>(.+)\<\/a\:p\>` とした場合、一番最後の `</a:p>` にヒットしていまい上手く抽出できない

- 貪欲 (greedy) 対非貪欲 (non-greedy)
    - from http://docs.python.jp/2/howto/regex.html
    - 貪欲: 可能な限り長いマッチを採用
    - 非貪欲: 可能な限り短いマッチを採用

貪欲な場合

```
>>> s = '<html><head><title>Title</title>'
>>> len(s)
32
>>> print re.match('<.*>', s).span()
(0, 32)
>>> print re.match('<.*>', s).group()
<html><head><title>Title</title>
```

非貪欲な場合

```
>>> print re.match('<.*?>', s).group()
<html>

```
