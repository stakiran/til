# Microsoft Forms の仕様メモ
https://forms.office.com/

## 使えるパーツ
- 選択肢
    - 複数回答可能
- テキスト
    - 長い回答（複数行）可能
- 評価
    - n段階(1-10まで)
    - シンボルは「★」か「radiobutton + 数字」か
- 日付
    - カレンダーで選ぶ
- ランキング
    - 並び替え可能な項目
    - 選択肢から選択機能引いて並び替え機能足した感じ
- リッカート
    - 縦軸にステートメント、横軸にオプション
    - 評価を二次元にして縦横ともにラベル書けるようにした感じ
- ファイルのアップロード
    - 回答者がアップロードできる
- ネットプロモーターズスコア
    - 評価の亜種で、n段階の左右に「～～でない」「～～である」など説明を付与したもの
    - nは10固定

## 各パーツが持つ情報
全パーツが持つ

- Title
    - 質問内容など
- Subtitle
    - タイトルの下にもう一行追加できる
    - デフォは無し
- 必須回答かどうか
    - デフォはfalse
- 分岐
    - 次はどの項目に飛ぶかを指定する
        - 次へ
        - 同セクション内の指定項目
        - 別セクションの指定項目
    - 選択肢に対して設定する
        - 選択肢がないパーツにも設定可能
        - 「唯一の選択肢に関する分岐を追加」という挙動になる
    - 回答時の挙動
        - 分岐先のパーツは **分岐元から条件満たした場合にのみ** 表示される

## Q: アンケート CRUD 後に回答した場合の回答者データはどうなる？
- **最後のアンケート状態をベースに** 結果集計される
- 未回答による空欄と既回答の消失が起こり得る

例:

- 以下のアンケをつくった
    - 質問1
- 回答者Aが答えた
    - 質問1=a
- アンケを修正
    - 質問1
    - 質問2
- 回答者Bが答えた
    - 質問1=b
    - 質問2=b
- アンケを修正（質問1を消した）
    - 質問2
- 回答者Cが答えた
    - 質問2=b
- **このとき、回答データはどう見える？**

こうなる
```
ID	開始時刻	完了時刻	メール	名前	質問2
Aさん (値なし)
Bさん b
Cさん b
```

一番最後のアンケ状態がベースになっている

- (未回答)(消失) Aさんは質問2に答えてないのでデータが空、かつ質問1の答えは消えている
- (消失) Bさんの質問1の答えは消えている
- Cさんのデータはちゃんと残っている

## Q: 確認メールの仕様は？
> 自分の回答についての確認メールを受け取る

- 回答者がチェックを入れることで、回答した旨を自分宛てに送信できる
- メールタイトル: `My responses (アンケート名)`
- メール本文は View My response リンク
    - 自分の回答をグレーアウトで示すpermalink

> 各回答の通知をメールで受け取る

- アンケート作成者が回答者が回答した旨を知ることができる
- メールタイトル: `New response for (アンケート名)`
- メール本文は View the result of your form
    - 管理画面

## アンケートとクイズ
- 基本的には一緒
- クイズはアンケートに加えて以下がある
    - 「得点」と「どうしたら正解になるか」を指定できる
    - 結果画面では回答正解率とか見れる

## アンケートをつくるまで
- トップページにアクセスして新規
- セクションとフォームを埋め込んでいく
- 共有ボタンから共有リンクつくる
    - 公開範囲は「リンク知ってる人なら誰でも」とグループ単位のコントロールがある
    - 詳しい仕様はわからん（365側のポリシー設定だとは思）
- 保存
    - 自動保存
    - 共有URLも変わらず（保存されたら反映される）

## 回答確認
- ウェブから統計と個別回答が見れる
- Excelで開くボタンからエクスポートもできる(xlsx形式)

```csv
ID	開始時刻	完了時刻	メール	名前	(アンケ項目1)	(項目2)	……
回答データ1
回答データ2
……
```

項目が横に並ぶ。回答者が縦に並ぶ。

## 共有できるURL
一部 URL エンコードの扱いが雑だが、こんなフォーマット

- 回答者用
    - https://forms.office.com/Pages/ResponsePage.aspx?id=XXXX
    - XXXX は 80 文字
- 複製用
    - https://forms.office.com/Pages/ShareFormPage.aspx?id=XXXX&sharetoken=YYYY
    - sharetoken は 20 文字
- 共同編集用
    - https://forms.office.com/Pages/DesignPage.aspx?fragment=FormId=XXXXToken=ZZZZ
    - token は 32 文字
