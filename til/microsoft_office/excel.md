# Excel

## Excelで列すべての表示幅を最大(ダブルクリック時の挙動)にする
- Ctrl + A > Ctrl + A でシート内全選択
- どこでもいいので列の境界をダブルクリック

## オートフィルタで抽出した行だけ削除する
- 全選択
- Alt + ;
- ホーム > セル > 削除 > シートの行を削除

Alt + ; で抽出行のみ選択するよう切り替えるのがミソ。

## 2013 他のセルを参照している値に、参照先の値そのものを埋め込む

```
シート全選択してコピー、
Alt + E > S で形式を選択して貼り付けを開く。
貼り付け欄は「値」を選ぶ。
```

これで値コピーになる。

## 2013 特定のシートだけ保存する
シートのコピーを「新しいブック」に対して作成する。そのブックを保存する。

## vlookup関数

```
| 100 | xxxx | yyyy | zzzz |
  ^^^
  ここを入れるだけで、
  100に関連する xxxx やら yyyy からも自動入力する関数。

  xxxx やら yyyy やらのセルが vlookup 使ってる。

  vlookup は 100 をキーに、指定した表から関連する値を探してくる関数
```

```
VLOOKUP(querykey,range,row,[option])
  querykey : 
  range    : 探す先の表の場所を、シート名とか範囲表記とかで指定
  row      : 探す先の表の、何列目を使うか
             (上例なら2だとxxxxの列、3ならyyyyの列)
  option   : 0=完全一致, 1 or 未入力=部分一致
```

例: `=VLOOKUP($A7,PriceList,4,FALSE)`

## 2013 非表示にされてる列を表示する
非表示にされてる列の一つ前/後の列の間がちょっと太くなってるはず。

前/後の列を両方選択、右クリックからの再表示でいける。

## 他シートの集計を表示したい時に使えるやつ
`=COUNT(INDIRECT("'"&F7&"'!$A1:$A65535"))`

これで「F7セルに書いてあるシート名」のシートの、A1:A65535 をカウントした結果を表示。

## 2003 家計簿の合計で使ってるやつ

```
=B4-SUMPRODUCT((INDIRECT("G4:G65536")="R")*INDIRECT("F4:F65536"))
```

```
sumproduct(配列1, 配列2)  array1[i]*array2[i] の sum みたいなやつ
indirect("A1")            セルA1に書かれた値をセル指定とみなしてアクセス
```

## IF 条件分岐

```
=if(i8<1000000,"S",if(i8<1007500,"SS","SSS"))
```

面倒なことに if-else はネストでしか書けない。最大7階層まで。

## オートコンプリートを無効にする in excel2010
ファイル > オプション > 詳細設定 > オートコンプリートを使用する をオフに

## 複数の列を対象に count する
countifs を使う

- c 列が "○" かつ d 列が "ok" の個数を数える
    - `countifs(c2:c7, "=○", d2:d7, "=ok")`

## 特定シートの特定セルを参照するには
`'シート名'!C7` みたいに。

''で囲むのがポイント。

## 行や列を非表示にする/再表示する

```
非表示:
非表示にしたい行/列を選択して、右クリックメニューから。

再表示:
非表示された行/列を選択して、右クリックメニューから。

非表示列の見つけ方
O P T U
  ~~~
  Q,R,S列が隠れている。
```

## 入力規則がグレーアウトされてて使えない場合
シートの保護や共有を解除する

## CPU使用率が 50% を超える
%appdata%\excel 配下の、XLSTART フォルダ以外のファイルを消す。

## メニューを全部表示する
- ツール > ユーザー設定 > オプション
- 常にすべてのメニューを表示する

## 行を入れてもズレない行番号の入れ方
セル A2 を基準としたい場合。

`MAX( OFFSET( $A$1 , 0 , 0 , ROW(A15) - ROW($A$1) , 1))+1`

とする。
- $A$1 部分は, 基準セルの一行上を絶対基準で指定したもの。
- A15は、本計算式を入れるセルの位置
  (オートフィルするとここがずれていく)

参考: http://takuan93.blog62.fc2.com/blog-entry-11.html
