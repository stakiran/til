# Jenkins

# 2.46.3 の話

## SCM に push されたら自動でジョブを走らせる
jobとrepo、双方から紐付ける必要がある。

ジョブ側の設定

- 1: ビルド・トリガの Build when a change is pushed…… にチェックを入れる

GitLab repo 側の設定

- 2: Settings > Integration > Add webhook から、1: の url を追加

## 他ジョブの成果物を利用するには
例: ジョブ1の成果物をジョブ2から利用したい場合

ジョブ1

```
  ・ビルド後の処理 > Jenkin に成果物を保存: 「保存するファイル」を指定
  ・ビルド後の処理 > パラメータを指定して他のジョブをビルド: ジョブ2をビルド
```

ジョブ2

```
  ・ビルド > 他ジョブから成果物をコピー:
    ジョブ名はジョブ1、
    対象ビルドは最新の成功ビルド、
    コピーする成果物は、ジョブ1の「保存するファイル」と同じパスを
```

## インストーラのバージョン番号に「SVNのリビジョン番号」を入れたい
SVN_REVISION 変数を使う。

from https://wiki.jenkins.io/display/JA/Building+a+software+project

## パラメータ付きビルド
パラメータ付きビルドをつくる

- ビルドのパラメータ化 → 文字列

これを追加すると、ビルドコマンドライン中で上記追加分パラメータを環境変数としてアクセスできる。

パラメータ付きビルドを他ジョブから呼び出す。

- ビルド → パラメータを指定して他のジョブをビルド にて
    - 「ビルドするジョブ」にジョブ名を入力
    - 「パラメータを追加」ボタンを押す
    - 「固定値」を選択
    - 「(文字列名)=30」みたいな感じで書く
